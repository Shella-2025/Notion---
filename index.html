<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ç€è¦½æ¬¡æ•¸å„€è¡¨æ¿</title>

<style>
:root{
  --card-bg:#F9F3DC;
  --text:#111;
  --muted:#444;
  --accent:#2b7a66;
  --shadow:0 10px 26px rgba(0,0,0,0.10);
  --radius:18px;
}

html,body{height:100%;}

body{
  margin:0;
  display:flex;
  justify-content:center;
  align-items:center;
  background:transparent;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans TC",sans-serif;
  color:var(--text);
}

.wrap{width:320px;max-width:92vw;}

.panel{
  background:var(--card-bg);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  padding:16px;
}

.head{
  display:flex;
  justify-content:space-between;
  margin-bottom:12px;
}

.title{font-weight:800;font-size:16px;}

.desc{font-size:12px;color:var(--muted);margin-top:4px;}

.pill{
  font-size:11px;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(255,255,255,0.55);
}

.stat{
  border-radius:14px;
  background:rgba(255,255,255,0.45);
  padding:14px;
  text-align:center;
  margin-bottom:10px;
}

.label{font-size:12px;color:var(--muted);}
.value{font-weight:800;font-size:28px;color:var(--accent);}

.reset{
  margin-top:8px;
  font-size:12px;
  cursor:pointer;
  text-align:center;
  opacity:0.7;
}

.reset:hover{opacity:1;}
</style>
</head>

<body>

<div class="wrap">
<div class="panel">

<div class="head">
<div>
<div class="title">ğŸ‘¥ ç€è¦½æ¬¡æ•¸å„€è¡¨æ¿</div>
<div class="desc">æ­¡è¿æ‚¨ä¾†,è‹¥æœ‰éœ€æ±‚è«‹ç›¡å¿«èˆ‡æˆ‘è¯ç¹«! :) </div>
</div>
</div>

<div class="stat">
<div class="label">ä»Šæ—¥é–‹å•Ÿ</div>
<div class="value" id="today">0</div>
</div>

<div class="stat">
<div class="label">ç¸½é–‹å•Ÿæ¬¡æ•¸</div>
<div class="value" id="total">0</div>
</div>

<div class="reset" id="resetBtn">é‡ç½®ç´€éŒ„</div>

</div>
</div>

<script>
/**
ğŸ‘¾ Notion æ¨¡æ¿å¼·åŒ–ç‰ˆè¨ˆæ•¸å™¨
- 30ç§’å…§ä¸é‡è¤‡è¨ˆç®—
- åŒæ—¥åˆ†é–‹çµ±è¨ˆ
- å¯æ‰‹å‹•é‡ç½®
*/

const KEY_TOTAL="notion-local-total";
const KEY_DAY="notion-local-day";
const KEY_LAST="notion-local-last-hit";

function animateNumber(el,target){
  target=Math.max(0,Math.floor(target||0));
  const start=0;
  const duration=500;
  const t0=performance.now();

  function tick(now){
    const p=Math.min(1,(now-t0)/duration);
    const eased=1-Math.pow(1-p,3);
    el.textContent=Math.floor(start+(target-start)*eased).toLocaleString();
    if(p<1)requestAnimationFrame(tick);
  }
  requestAnimationFrame(tick);
}

function todayStr(){
  const d=new Date();
  return d.getFullYear()+"-"+(d.getMonth()+1)+"-"+d.getDate();
}

(function(){

  let total=parseInt(localStorage.getItem(KEY_TOTAL)||"0",10);
  let dayData=JSON.parse(localStorage.getItem(KEY_DAY)||"{}");

  const now=Date.now();
  const last=parseInt(localStorage.getItem(KEY_LAST)||"0",10);

  // ===== 30ç§’é˜²æš´è¡ =====
  if(now-last>30000){

    total++;
    localStorage.setItem(KEY_TOTAL,total);

    const today=todayStr();
    dayData[today]=(dayData[today]||0)+1;
    localStorage.setItem(KEY_DAY,JSON.stringify(dayData));

    localStorage.setItem(KEY_LAST,now);
  }

  const today=todayStr();
  animateNumber(document.getElementById("total"),total);
  animateNumber(document.getElementById("today"),dayData[today]||0);

})();

// ===== é‡ç½®æŒ‰éˆ• =====
document.getElementById("resetBtn").onclick=function(){
  if(confirm("ç¢ºå®šè¦æ¸…é™¤ç´€éŒ„å—ï¼Ÿ")){
    localStorage.clear();
    location.reload();
  }
};
</script>

</body>
</html>
